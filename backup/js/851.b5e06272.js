"use strict";(self["webpackChunkforesee"]=self["webpackChunkforesee"]||[]).push([[851],{56851:function(e,t,i){i.r(t),i.d(t,{default:function(){return N}});var s=function(){var e=this,t=e._self._c;return t("v-main",[t("v-card",{attrs:{tile:"",flat:""}},[t("Appbar"),t("Drawer"),t("v-container",{attrs:{fluid:""}},[t("v-row",{staticClass:"py-3",attrs:{"no-gutters":"",align:"center"}},[t("v-col",[t("div",{staticClass:"ml-4"},[t("div",{staticClass:"text-h6"},[t("number",{staticClass:"mr-1",attrs:{from:0,to:e.count,duration:1,format:e.FormatWithCommas,delay:0,easing:"Power1.easeIn"}}),e._v(e._s(e.$route.name)+" ")],1),t("div",{staticClass:"text-caption mb-2"},[e._v("Products table")]),t("v-btn",{staticClass:"mr-3",attrs:{color:"primary",small:""},on:{click:e.ShowUploadProductList}},[e._v("UPLOAD PRODUCT LIST")]),t("v-btn",{attrs:{color:"primary",small:""},on:{click:e.ShowAddProduct}},[e._v("ADD PRODUCT")])],1)])],1),t("v-row",{staticClass:"mt-1 px-4",attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"12"}},[t("v-card",{attrs:{id:"FancyTable",outlined:""}})],1)],1)],1)],1),t("Alert",{ref:"Alert"}),t("Snackbar",{ref:"Snackbar"}),t("AddProduct",{ref:"AddProduct",on:{NewProduct:e.NewProduct}}),t("UploadProductList",{ref:"UploadProductList",on:{Uploaded:e.Uploaded}})],1)},l=[],r=i(79113),o=i(51299),a=i.n(o),n=i(53280),d=i(81671),c=function(){var e=this,t=e._self._c;return t("section",[t("v-dialog",{attrs:{persistent:"","max-width":"800",transition:"dialog-top-transition"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[t("div",{attrs:{id:"Modal"}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[t("defs",[t("linearGradient",{attrs:{id:"ModalSVGGradient"}},[t("stop",{attrs:{offset:"0%","stop-color":"#b33bf5"}}),t("stop",{attrs:{offset:"80%","stop-color":"#7b68ee"}})],1)],1),t("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),t("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),t("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"10"}},[t("div",{staticClass:"text-h5 font-weight-thin"},[e._v("Add Product")])]),t("v-col",{attrs:{cols:"2",align:"end"}},[t("v-icon",{attrs:{size:"24"},on:{click:function(t){e.visible=!1}}},[e._v("mdi-close")])],1)],1)],1),t("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"190px !important"}},[t("v-form",{ref:"AddProduct",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"SSS",expression:"'SSS'"}],ref:"section",attrs:{rules:[e.validators.required],label:"Section *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.section,callback:function(t){e.section="string"===typeof t?t.trim():t},expression:"section"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"#############",expression:"'#############'"}],attrs:{rules:[e.validators.required],label:"Barcode *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.barcode,callback:function(t){e.barcode="string"===typeof t?t.trim():t},expression:"barcode"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Name *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"###",expression:"'###'"}],attrs:{rules:[e.validators.required],label:"Quantity *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.quantity,callback:function(t){e.quantity="string"===typeof t?t.trim():t},expression:"quantity"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Color Code *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.ColorCode,callback:function(t){e.ColorCode="string"===typeof t?t.trim():t},expression:"ColorCode"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Color *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.color,callback:function(t){e.color="string"===typeof t?t.trim():t},expression:"color"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Size *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.size,callback:function(t){e.size="string"===typeof t?t.trim():t},expression:"size"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Length *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.length,callback:function(t){e.length="string"===typeof t?t.trim():t},expression:"length"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12",md:"6"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Special Code *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.SpecialCode,callback:function(t){e.SpecialCode="string"===typeof t?t.trim():t},expression:"SpecialCode"}})],1),t("v-col",{staticClass:"px-2 pt-3 pb-6",attrs:{cols:"12",align:"end"}},[t("v-btn",{attrs:{color:"primary",height:"35",rounded:"",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.AddProduct}},[e._v("ADD PRODUCT")])],1)],1)],1)],1)],1)],1),t("Alert",{ref:"Alert"})],1)},u=[],p={data(){return{visible:!1,loading:!1,valid:!1,section:null,barcode:null,name:null,quantity:null,ColorCode:null,color:null,size:null,length:null,SpecialCode:null}},methods:{AddProduct(){this.loading=!0,this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Products/Add/`,{method:"post",body:JSON.stringify({token:this.$store.getters.token,section:this.section,barcode:this.barcode,name:this.name,quantity:this.quantity,ColorCode:this.ColorCode,color:this.color,size:this.size,length:this.length,SpecialCode:this.SpecialCode})})).then((e=>{e.text().then((t=>{e.status>200?this.$refs.Alert.Alertify({title:"Error occurred!",content:t,visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"}):(this.$refs.AddProduct.reset(),this.$emit("NewProduct",JSON.parse(t)),this.visible=!1)}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.loading=!1}))}}},m=p,v=i(1001),h=(0,v.Z)(m,c,u,!1,null,null,null),f=h.exports,g=function(){var e=this,t=e._self._c;return t("section",[t("v-dialog",{attrs:{persistent:"","max-width":"700",transition:"dialog-top-transition"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[t("div",{attrs:{id:"Modal-divider-top"}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[t("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),t("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),t("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"10"}},[t("div",{staticClass:"text-h5 font-weight-thin"},[e._v("Upload Product List")])]),t("v-col",{attrs:{cols:"2",align:"end"}},[t("v-icon",{attrs:{size:"24"},on:{click:function(t){e.visible=!1}}},[e._v("mdi-close")])],1)],1)],1),t("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"190px !important"}},[t("v-form",{ref:"UploadProductList",staticClass:"CustomFormModifier",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t("v-row",{attrs:{justify:"center","no-gutters":""}},[t("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[t("v-card",{staticClass:"pt-5 pb-2",staticStyle:{"background-color":"#efefef",border:"2px dashed #bdbdbd !important","border-radius":"25px",overflow:"hidden"},attrs:{dark:"",flat:""}},[t("input",{attrs:{type:"file",name:"attachment"}})])],1),e.DBcolumns.length>0||e.excelFields.length>0?t("v-data-table",{staticClass:"mt-5 CustomVerticalTable",attrs:{headers:[{text:"Column  in database",value:"column"},{text:"Excel field to match",value:"field"}],items:e.DBcolumns,"disable-sort":"","hide-default-footer":""},scopedSlots:e._u([{key:"item.column",fn:function({item:i}){return[t("v-col",{attrs:{justify:"center"}},[t("div",{staticClass:"text-subtitle-2 blue--text"},[e._v(" "+e._s(i.column)+" ")])])]}},{key:"item.field",fn:function({item:i}){return[t("v-col",{attrs:{justify:"center"}},[t("v-select",{attrs:{rules:"barcode"===i.column||("Barcode"===i.column?[e.validators.required]:[]),items:e.excelFields,label:"barcode"===i.column||"Barcode"===i.column?"Excel field (Required) *":"Excel field (Optional)","item-text":"field","item-value":"field",dense:"","hide-details":"",outlined:""},scopedSlots:e._u([{key:"item",fn:function(i){return[t("v-list",{attrs:{dense:"","two-line":""}},[t("v-list-item",[t("v-list-item-content",[t("v-list-item-title",{staticClass:"text-subtitle-2"},[e._v(e._s(i.item.field))]),t("v-list-item-subtitle",[t("span",[e._v("Sample:Â ")]),t("span",{staticClass:"text-caption grey--text"},[e._v(e._s(i.item.sample))])])],1)],1)],1)]}}],null,!0),model:{value:i.excelField,callback:function(t){e.$set(i,"excelField",t)},expression:"item.excelField"}})],1)]}}],null,!1,44769955)}):e._e(),t("v-col",{staticClass:"px-2 pt-8 pb-6",attrs:{cols:"12",align:"center"}},[t("v-btn",{attrs:{color:"primary",height:"35",width:"300",rounded:"",loading:e.loading,disabled:!e.valid||e.loading||0===e.DBcolumns.length||0===e.excelFields.length},on:{click:e.Commit}},[e._v("COMMIT")])],1)],1)],1)],1)],1)],1),t("Alert",{ref:"Alert"})],1)},x=[],b=i(22575),y=i(30008),C=i.n(y),S=i(43339),w=i.n(S),k=i(77757),P=i.n(k),$=i(3649),A=i.n($),F=i(12548),T=i.n(F),z=i(95513),B=i.n(z),_={data(){return{visible:!1,loading:!1,valid:!1,excelFields:[],DBcolumns:[],filename:null}},methods:{Show(){new Promise((e=>{e(this.visible=!0)})).then((()=>{let e=null,t=null,i=null,s=null;b.registerPlugin(C(),w(),P(),A(),T(),B()),b.setOptions({server:{url:this.$store.getters.endpoint+"Products/?Upload",process:{method:"post",headers:{Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},ondata:l=>(l.forEach((e=>{JSON.stringify(e).indexOf("token")>-1&&(s=JSON.parse(e))})),JSON.stringify({UUID:e,Base64Image:t,Base64ImageMetadata:i,FormData:s})),onload:e=>{const t=JSON.parse(e);this.excelFields=t.excelFields,this.DBcolumns=t.DBcolumns,this.filename=t.filename},onerror:e=>{this.$refs.Alert.Alertify({visible:!0,content:e,title:"Upload error",icon:"mdi-progress-alert",color:"error"})}}},maxFileSize:"5MB",labelMaxFileSizeExceeded:"File is too large",labelMaxFileSize:"Maximum file size is {filesize}",acceptedFileTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],labelFileTypeNotAllowed:"File of invalid type",fileValidateTypeLabelExpectedTypes:"Expects .XLSX .XLS .CSV",allowImagePreview:!0,imagePreviewMinHeight:44,imagePreviewMaxHeight:200,imagePreviewMaxFileSize:"5MB",imagePreviewTransparencyIndicator:"#39b54a",imagePreviewMaxInstantPreviewFileSize:1e6,imageTransformOutputMimeType:"image/jpeg",imageTransformOutputQuality:70,imagePreviewHeight:200,imageCropAspectRatio:"1:1",imageResizeTargetWidth:100,imageResizeTargetHeight:200,dropOnPage:!0,onaddfile:(t,i)=>{e=i.id},onremovefile:(e,t)=>{this.DBcolumns=[],this.excelFields=[]},onpreparefile:(e,s)=>{t=e.getFileEncodeBase64String(),i={name:s.name,size:s.size,type:s.type}},labelIdle:`<div style="cursor:pointer; z-index: 1; background: transparent; ">\n                    <img style="font-size:40px;color:#39b54a;width:30px;height:30px" src="${this.$store.getters.server}img/attachment.png"/>\n                    <div class="primary--text" style="font-size:15px; font-weight:400;">Upload excel file here</div>\n                    <div class="my-1" style="font-size: 9px; opacity:.7">Only XLS, XLSX, CSV allowed</div>\n                    <div class="text-body-2">Size less than 5 MB</div>\n                    </div>`}),this.pond=b.create(document.querySelector("[name*=attachment]"))}))},Commit(){this.loading=!0,this.promiseFetch(3e5)(fetch(`${this.$store.getters.endpoint}Products/?Commit`,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({filename:this.filename,mappings:this.DBcolumns})})).then((e=>e.json().then((t=>{e.status>201?this.$refs.Alert.Alertify({title:t.title,content:t.content,visible:!0,icon:"mdi-progress-close",color:"warning"}):(this.pond.removeFiles(),this.$emit("Uploaded",t.count),this.visible=!1)})))).catch((e=>this.$refs.Alert.Alertify({visible:!0,content:e.message||this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"}))).finally((()=>this.loading=!1))}}},D=_,L=(0,v.Z)(D,g,x,!1,null,null,null),O=L.exports;a().stylesLoaded=!0;var U={components:{Appbar:r.Z,Drawer:n.Z,Snackbar:d.Z,AddProduct:f,UploadProductList:O},data(){return{loading:!1,FancyGrid:{},count:0,FancyGridDefaults:{sortable:!0,editable:!1,resizable:!0,ellipsis:!1,filter:{header:!0,emptyText:"Search"}}}},mounted(){this.$vuetify.breakpoint.mdAndUp&&(this.FancyGridDefaults["flex"]=1),new Promise((e=>{e(1===this.FancyGridDefaults["flex"])})).then((()=>{this.FancyGrid=new(a().Grid)({renderTo:"FancyTable",theme:{name:"blue"},tbar:[{text:"Export to CSV",handler:()=>{this.exportToCSV({fileName:"Products",header:!0})}},{text:"Refresh",handler:()=>{this.FancyGrid.load()}}],height:"fit",selModel:"rows",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:1,columns:[{type:"order",locked:!0},{index:"id",title:"PK",hidden:!0},{index:"barcode",locked:!0,title:"Barcode",width:100,editable:!0},{index:"SpecialCode",title:"Special Code",width:100},{index:"section",title:"Section"},{index:"location",title:"Location"},{index:"name",title:"Name"},{index:"quantity",title:"Quantity",editable:!0},{index:"size",title:"Size"},{index:"length",title:"Length"},{index:"ColorCode",title:"Color Code"},{type:"combo",index:"color",title:"Color",data:["Brown","Khaki","Caramel","Black"]},{index:"LastScannedBy",title:"Last Scanned By"},{index:"LastScannedOn",title:"Last Scanned On"}],data:{remotePage:!0,remoteFilter:!0,proxy:{autoLoad:!0,autoSave:!1,url:`${this.$store.getters.endpoint}Products/Get/`,params:{token:this.$store.getters.token},writer:{type:"json"},beforeRequest:e=>(this.$Progress.start(),e),afterRequest:e=>(this.$Progress.finish(),this.count=e.response.totalCount,e)}},paging:{pageSize:20,pageSizeData:[5,10,15,20,50],inputWidth:100,refreshButton:!0},events:[{change:(e,t)=>{this.$Progress.start(),this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Products/Edit/`,{method:"post",body:JSON.stringify({token:this.$store.getters.token,key:t.id,entity:t.key,value:t.value})})).then((e=>{e.text().then((()=>{e.status>200?(this.$Progress.fail(),this.$refs.Alert.Alertify({title:"Update Error!",content:"The last change you made could not be saved. Kindly retry.",visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"})):(this.$refs.Snackbar.Snackify({visible:!0,content:"Changes saved!",color:"success",timeout:2e3}),this.FancyGrid.save(t))}))})).catch((()=>{this.$Progress.fail(),this.$refs.Alert.Alertify({title:"Connection Timeout",content:this.$store.getters.fetchTimeoutError,visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.$Progress.finish()}))}}]})}))},methods:{ShowAddProduct(){this.$refs.AddProduct.visible=!0,setTimeout((()=>{this.$refs.AddProduct.$refs.section.focus()}),100)},ShowUploadProductList(){this.$refs.UploadProductList.Show()},NewProduct(e){this.FancyGrid.add(e),this.$refs.Snackbar.Snackify({visible:!0,content:`Added ${e.name} to products.`,color:"success",timeout:3e3})},Uploaded(e){this.FancyGrid.load(),this.$refs.Snackbar.Snackify({visible:!0,content:`${e} products have been added to the product list.`,color:"success",timeout:3e3})}}},q=U,M=(0,v.Z)(q,s,l,!1,null,null,null),N=M.exports}}]);