"use strict";(self["webpackChunkforesee"]=self["webpackChunkforesee"]||[]).push([[999],{45999:function(e,t,i){i.r(t),i.d(t,{default:function(){return I}});var s=function(){var e=this,t=e._self._c;return t("v-main",[t("Appbar"),t("v-container",[t("v-row",{staticClass:"py-3",attrs:{"no-gutters":"",align:"center"}},[t("v-col",[t("div",{staticClass:"text-h6"},[e._v(e._s(e.$route.name))]),t("v-btn",{staticClass:"mt-3",attrs:{small:"",color:"primary",outlined:""},on:{click:function(t){e.$refs.AddUser.visible=!0}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v("ADD USER")],1)],1)],1),t("v-row",{staticClass:"mt-3",attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"12"}},[t("v-card",{attrs:{id:"FancyTable",flat:""}})],1)],1)],1),t("v-dialog",{attrs:{persistent:"","max-width":"265",transition:"dialog-top-transition"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("v-card",{staticClass:"rounded-lg px-8 py-6",attrs:{flat:""}},[t("v-row",{attrs:{align:"center","no-gutters":""}},[t("v-col",{attrs:{cols:"10"}},[t("div",{staticClass:"text-h6 font-weight-thin"},[e._v("Upload Photo")])]),t("v-col",{attrs:{cols:"2",align:"end"}},[t("v-icon",{attrs:{size:"24"},on:{click:function(t){e.visible=!1}}},[e._v("mdi-close")])],1)],1),t("div",{staticClass:"pt-2 pb-0"},[t("v-card",{staticClass:"pa-1 rounded-circle",staticStyle:{"background-color":"#efefef",border:"2px dashed #bdbdbd !important","border-radius":"5px",overflow:"hidden"},attrs:{dark:"",flat:"",width:"200",height:"200"}},[t("input",{attrs:{type:"file",name:"attachment"}})])],1)],1)],1),t("Drawer"),t("Alert",{ref:"Alert"}),t("Snackbar",{ref:"Snackbar"}),t("AddUser",{ref:"AddUser",on:{NewUser:e.NewUser}}),t("EditPassword",{ref:"EditPassword",on:{Edited:e.Edited}}),t("Confirm",{ref:"Confirm",on:{confirm:e.Confirm,cancel:e.Confirm}})],1)},r=[],a=i(79113),o=i(51299),n=i.n(o),l=i(81671),d=i(53280),c=function(){var e=this,t=e._self._c;return t("section",[t("v-dialog",{attrs:{persistent:"","max-width":"400",transition:"dialog-top-transition"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[t("div",{attrs:{id:"ModalUser"}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[t("defs",[t("linearGradient",{attrs:{id:"UserSVGGradient"}},[t("stop",{attrs:{offset:"0%","stop-color":"#b33bf5"}}),t("stop",{attrs:{offset:"80%","stop-color":"#7b68ee"}})],1)],1),t("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),t("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),t("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"10"}},[t("div",{staticClass:"text-h5 font-weight-thin"},[e._v("Add User")])]),t("v-col",{attrs:{cols:"2",align:"end"}},[t("v-icon",{attrs:{size:"24"},on:{click:function(t){e.visible=!1}}},[e._v("mdi-close")])],1)],1)],1),t("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"190px !important"}},[t("v-form",{ref:"AddUser",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"First Name *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},on:{keyup:e.GenerateUsername},model:{value:e.FirstName,callback:function(t){e.FirstName="string"===typeof t?t.trim():t},expression:"FirstName"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Last Name *",filled:"",rounded:"","prepend-inner-icon":"mdi-account-circle"},on:{keyup:e.GenerateUsername},model:{value:e.LastName,callback:function(t){e.LastName="string"===typeof t?t.trim():t},expression:"LastName"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"User *",filled:"",rounded:"",readonly:"",disabled:"","prepend-inner-icon":"mdi-account-circle"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[t("v-select",{attrs:{rules:[e.validators.required],items:e.roles,label:"Role *",filled:"",rounded:"","prepend-inner-icon":"mdi-domain"},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}})],1),t("v-col",{staticClass:"px-2 pt-3 pb-6",attrs:{cols:"12",align:"end"}},[t("v-btn",{attrs:{color:"primary",height:"35",rounded:"",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.AddUser}},[e._v("ADD USER")])],1)],1)],1)],1)],1)],1),t("Alert",{ref:"Alert"})],1)},h=[],p={data(){return{visible:!1,loading:!1,valid:!1,FirstName:null,LastName:null,username:null,role:null,roles:["Super Admin","Supervisor","Scanner"]}},methods:{AddUser(){this.loading=!0,this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Users/`,{method:"post",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({firstName:this.FirstName,lastName:this.LastName,username:this.username,role:this.role})})).then((e=>{e.text().then((t=>{e.status>200?this.$refs.Alert.Alertify({title:"Error occurred!",content:t,visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"}):(this.$refs.AddUser.reset(),this.$emit("NewUser",JSON.parse(t)),this.visible=!1)}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.loading=!1}))},GenerateUsername(){this.FirstName&&this.LastName&&(this.username=`${this.FirstName.toLowerCase().substring(0,1)}${this.LastName.toLowerCase()}`)}}},f=p,m=i(1001),u=(0,m.Z)(f,c,h,!1,null,null,null),v=u.exports,g=function(){var e=this,t=e._self._c;return t("section",[t("v-dialog",{attrs:{persistent:"","max-width":"400",transition:"dialog-top-transition"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[t("div",{attrs:{id:"ModalPassword"}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[t("defs",[t("linearGradient",{attrs:{id:"PasswordSVGGradient"}},[t("stop",{attrs:{offset:"0%","stop-color":"#b33bf5"}}),t("stop",{attrs:{offset:"80%","stop-color":"#7b68ee"}})],1)],1),t("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),t("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),t("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"10"}},[t("div",{staticClass:"text-h5 font-weight-thin"},[e._v("Edit Password")])]),t("v-col",{attrs:{cols:"2",align:"end"}},[t("v-icon",{attrs:{size:"24"},on:{click:function(t){e.visible=!1}}},[e._v("mdi-close")])],1)],1)],1),t("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"190px !important"}},[t("v-form",{ref:"EditPassword",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[t("v-text-field",{attrs:{rules:[e.validators.required],label:"Password *",filled:"",rounded:"","prepend-inner-icon":"mdi-lock"},model:{value:e.password,callback:function(t){e.password="string"===typeof t?t.trim():t},expression:"password"}})],1),t("v-col",{staticClass:"px-2 pt-3 pb-6",attrs:{cols:"12",align:"end"}},[t("v-btn",{attrs:{color:"primary",height:"35",rounded:"",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.EditPassword}},[e._v("Edit Password")])],1)],1)],1)],1)],1)],1),t("Alert",{ref:"Alert"})],1)},b=[],y={data(){return{visible:!1,loading:!1,valid:!1,index:null,username:null,password:null}},methods:{EditPassword(){this.loading=!0,this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Users/`,{method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({username:this.username,entity:"password",value:this.password})})).then((e=>{e.text().then((t=>{e.status>200?this.$refs.Alert.Alertify({title:"Error occurred!",content:t,visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"}):(this.$emit("Edited",{index:this.index,password:this.password}),this.$refs.EditPassword.reset(),this.visible=!1)}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.loading=!1}))}}},w=y,x=(0,m.Z)(w,g,b,!1,null,null,null),$=x.exports,C=i(22575),A=i(30008),k=i.n(A),P=i(43339),S=i.n(P),E=i(77757),N=i.n(E),F=i(3649),U=i.n(F),T=i(12548),G=i.n(T),z=i(95513),L=i.n(z);n().stylesLoaded=!0;var O={components:{Appbar:a.Z,Snackbar:l.Z,AddUser:v,EditPassword:$,Drawer:d.Z},data(){return{loading:!1,FancyGrid:{},FancyGridDefaults:{sortable:!0,editable:!1,resizable:!0,ellipsis:!1},visible:!1,selected:null}},mounted(){this.$vuetify.breakpoint.mdAndUp&&(this.FancyGridDefaults["flex"]=1),new Promise((e=>{e(1===this.FancyGridDefaults["flex"])})).then((()=>{this.FancyGrid=new(n().Grid)({renderTo:"FancyTable",theme:"material",tbar:[{text:"Export to CSV",handler:function(){this.exportToCSV({fileName:"Users",header:!0})}}],width:"fit",height:"fit",selModel:"rows",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:1,cellHeight:60,align:"center",cellAlign:"center",columns:[{index:"id",title:"#",width:50},{type:"image",title:"Photo",index:"profilePicture",width:80,cls:"photo"},{type:"action",title:"Change Photo",width:100,filter:!1,resizable:!1,items:[{text:"<v-btn>CHANGE</v-btn>",cls:"change-photo",handler:(e,t)=>{this.visible=!0,new Promise((e=>{e(this.visible=!0)})).then((()=>{let e=null,i=null,s=null,r=null;C.registerPlugin(k(),S(),N(),U(),G(),L()),C.setOptions({server:{url:this.$store.getters.endpoint+"FileUploader/",process:{method:"post",ondata:a=>(a.forEach((e=>{JSON.stringify(e).indexOf("token")>-1&&(r=JSON.parse(e))})),JSON.stringify({UUID:e,Base64Image:i,Base64ImageMetadata:s,FormData:r,username:t.data.username})),onload:e=>{console.log(t.rowIndex),this.visible=!1,this.FancyGrid.set(t.rowIndex,"profilePicture",null),setTimeout((()=>{this.FancyGrid.set(t.rowIndex,"profilePicture",JSON.parse(e).URL)}),1e3)},onerror:e=>{this.$refs.Alert.Alertify({visible:!0,content:e,title:"Upload error",icon:"mdi-progress-alert",color:"error"})}}},maxFileSize:"5MB",labelMaxFileSizeExceeded:"File is too large",labelMaxFileSize:"Maximum file size is {filesize}",acceptedFileTypes:["image/png","image/jpeg","image/jpg"],labelFileTypeNotAllowed:"File of invalid type",fileValidateTypeLabelExpectedTypes:"Expects .PNG .JPG .JPEG",allowImagePreview:!0,imagePreviewMinHeight:44,imagePreviewMaxHeight:256,imagePreviewMaxFileSize:"5MB",imagePreviewTransparencyIndicator:"#39b54a",imagePreviewMaxInstantPreviewFileSize:1e6,imageTransformOutputMimeType:"image/jpeg",imageTransformOutputQuality:70,imagePreviewHeight:250,imageCropAspectRatio:"1:1",imageResizeTargetWidth:250,imageResizeTargetHeight:250,stylePanelLayout:"compact circle",styleLoadIndicatorPosition:"center bottom",styleProgressIndicatorPosition:"right bottom",styleButtonRemoveItemPosition:"left bottom",styleButtonProcessItemPosition:"right bottom",dropOnPage:!0,onaddfile:(t,i)=>{e=i.id},onremovefile:(e,t)=>{this.reupload.uploads=this.reupload.uploads.filter((e=>e!==t.id))},onpreparefile:(e,t)=>{i=e.getFileEncodeBase64String(),s={name:t.name,size:t.size,type:t.type}},labelIdle:`<div style="cursor:pointer; z-index: 1; background: transparent">\n                                  <img style="font-size:40px;color:#39b54a;width:30px;height:30px" src="${this.$store.getters.server}img/attachment.png"/>\n                                  <div class="primary--text" style="font-size:15px; font-weight:400;">Upload avatar here</div>\n                                  <div class="my-1" style="font-size: 9px; opacity:.7">Only JPG, PNG, GIF allowed</div>\n                                  <div class="text-body-2">Size less than 5 MB</div>\n                                  </div>`}),this.pond=C.create(document.querySelector("[name*=attachment]"),{fileMetadataObject:{token:this.$store.getters.token}})}))}}]},{index:"firstName",title:"FirstName"},{index:"lastName",title:"LastName"},{index:"username",title:"Username"},{type:"action",title:"Password",align:"left",width:100,filter:!1,resizable:!1,items:[{text:"<v-btn>CHECK</v-btn>",cls:"view-password",handler:(e,t)=>{this.$refs.EditPassword.visible=!0,this.$refs.EditPassword.index=t.rowIndex,this.$refs.EditPassword.username=t.data.username,this.$refs.EditPassword.password=t.data.password}}]},{index:"role",title:"Role",type:"combo",data:["Super Admin","Supervisor","Scanner"],editable:!0},{index:"addedBy",title:"Added By"},{index:"addedOn",title:"Added On"},{type:"action",title:"Actions",align:"center",width:75,filter:!1,rightLocked:!0,resizable:!1,items:[{text:"<v-btn>DELETE</v-btn>",cls:"delete-user",handler:(e,t)=>{this.Confirm({task:"show",operation:"delete",color:"error",metadata:{key:t.id,object:t},icon:"mdi-delete-variant",content:`Proceed to remove ${t.data.username}?`,title:"Delete user"})}}]}],data:{proxy:{autoLoad:!0,autoSave:!1,url:`${this.$store.getters.endpoint}Users/`,beforeRequest:e=>(this.loading=!0,e.headers["Authorization"]=`Bearer ${this.$store.getters.token}`,e)}},events:[{change:(e,t)=>{this.$Progress.start(),this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Users/`,{method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({username:t.data.username,entity:t.key,value:t.value})})).then((e=>{e.text().then((()=>{e.status>200?(this.$Progress.fail(),this.$refs.Alert.Alertify({title:"Update Error!",content:"The last change you made could not be saved. Kindly retry.",visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"})):(this.$refs.Snackbar.Snackify({visible:!0,content:"Changes saved!",color:"success",timeout:2e3}),this.FancyGrid.save(t))}))})).catch((()=>{this.$Progress.fail(),this.$refs.Alert.Alertify({title:"Connection Timeout",content:this.$store.getters.fetchTimeoutError,visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.$Progress.finish()}))}}]})}))},methods:{Confirm(e){if("show"===e.task)this.$refs.Confirm.Confirmify({visible:!0,task:e.task,operation:e.operation,metadata:e.metadata,content:e.content,title:e.title,icon:e.icon||"mdi-help-circle",color:e.color||"orange",truth:e.truth||"YES",falsy:e.falsy||"NO"});else if(e.task){if(this.$refs.Confirm.Confirmify({visible:!1}),"delete"===this.$refs.Confirm.confirm.operation){let e=this.$refs.Confirm.confirm.metadata,t=e.object;this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Users/`,{method:"DELETE",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({username:t.data.username})})).then((e=>{e.text().then((()=>{e.status>200?this.$refs.Alert.Alertify({visible:!0,content:"Error while deleting section. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.FancyGrid.remove(t),this.$refs.Snackbar.Snackify({visible:!0,content:"Section removed!",color:"success",timeout:2e3}))}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.loading=!1}))}}else e.task||this.$refs.Confirm.Confirmify({visible:!1})},ShowAddStore(){this.$refs.AddSection.visible=!0,setTimeout((()=>{this.$refs.AddSection.$refs.SectionCode.focus()}),100)},NewUser(e){this.FancyGrid.insert(e),this.$refs.Snackbar.Snackify({visible:!0,content:`Added ${e.username} to sections.`,color:"success",timeout:3e3})},Edited(e){this.FancyGrid.set(e.index,"password",e.password),this.$refs.Snackbar.Snackify({visible:!0,content:"Password edited.",color:"success",timeout:3e3})}}},_=O,B=(0,m.Z)(_,s,r,!1,null,null,null),I=B.exports}}]);