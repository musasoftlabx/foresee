"use strict";(self["webpackChunkforesee"]=self["webpackChunkforesee"]||[]).push([[511],{14511:function(t,e,i){i.r(e),i.d(e,{default:function(){return A}});var r=function(){var t=this,e=t._self._c;return e("v-main",[e("v-card",{attrs:{tile:"",flat:""}},[e("Appbar"),e("Drawer"),e("v-container",{attrs:{fluid:""}},[e("v-row",{staticClass:"pt-3",attrs:{"no-gutters":"",align:"center"}},[e("v-col",[e("div",{staticClass:"ml-4"},[e("div",{staticClass:"text-h6"},[t._v("Scans")]),e("div",{staticClass:"text-caption"},[t._v(" Reporting of scans made in this store ")])])])],1),e("v-row",{staticClass:"mt-1 px-4"},[e("v-col",{attrs:{cols:"12"}},[e("v-card",{attrs:{id:"FancyTable",outlined:""}})],1),e("v-col",{attrs:{cols:"12"}},[e("v-card",{attrs:{id:"Failed",outlined:""}})],1),e("v-col",{attrs:{cols:"4"}},[e("v-card",{attrs:{id:"Grouped",outlined:""}})],1),e("v-spacer"),e("v-col",{attrs:{cols:"8"}},[e("v-card",{attrs:{id:"Discrepancies",outlined:""}})],1)],1)],1)],1),e("Alert",{ref:"Alert"}),e("Snackbar",{ref:"Snackbar"}),e("Confirm",{ref:"Confirm",on:{confirm:t.Confirm,cancel:t.Confirm}}),e("ExportRange",{ref:"ExportRange"}),e("AddBarcode",{ref:"AddBarcode",on:{Closed:t.AddBarcodeClosed}})],1)},s=[],o=i(63348),a=i(15442),n=i.n(a),l=i(90427),d=i(46500),c=function(){var t=this,e=t._self._c;return e("section",[e("v-dialog",{attrs:{persistent:"","max-width":"300",transition:"dialog-top-transition"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[e("div",{attrs:{id:"Modal-divider-top"}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[e("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),e("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),e("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"10"}},[e("div",{staticClass:"text-h5 font-weight-thin"},[t._v("Export Range")])]),e("v-col",{attrs:{cols:"2",align:"end"}},[e("v-icon",{attrs:{size:"24"},on:{click:function(e){t.visible=!1}}},[t._v("mdi-close")])],1)],1)],1),e("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"190px !important"}},[e("v-form",{ref:"ExportRange",staticClass:"CustomFormModifier",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-row",[e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"####",expression:"'####'"}],staticClass:"my-3",attrs:{rules:[t.validators.required],clearable:"",dense:"",outlined:"",label:"From"},model:{value:t.range.from,callback:function(e){t.$set(t.range,"from",e)},expression:"range.from"}})],1),e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"####",expression:"'####'"}],staticClass:"my-3",attrs:{rules:[t.validators.required],clearable:"",dense:"",outlined:"",label:"To"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.ExportRange.apply(null,arguments)}},model:{value:t.range.to,callback:function(e){t.$set(t.range,"to",e)},expression:"range.to"}})],1)],1),e("v-row",{attrs:{"no-gutters":"",justify:"center"}},[e("v-btn",{staticClass:"mt-3 mb-5",attrs:{color:"primary",outlined:"",disabled:!t.valid},on:{click:t.ExportRange}},[t._v("EXPORT")])],1)],1)],1)],1)],1),e("Alert",{ref:"Alert"})],1)},h=[],p={data(){return{visible:!1,valid:!1,range:{from:null,to:null}}},methods:{ExportRange(){location.href=`${this.$store.getters.endpoint}Scans/Get/IndividualRange/?storeId=${this.$route.params.id}&token=${this.$store.getters.token}&from=${this.range.from}&to=${this.range.to}`,this.visible=!1}}},u=p,f=i(61431),m=(0,f.Z)(u,c,h,!1,null,null,null),v=m.exports,g=function(){var t=this,e=t._self._c;return e("section",[e("v-dialog",{attrs:{persistent:"","max-width":"300",transition:"dialog-top-transition"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[e("div",{attrs:{id:"Modal-divider-top"}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[e("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),e("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),e("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"10"}},[e("div",{staticClass:"text-h5 font-weight-thin"},[t._v("Add Barcode")])]),e("v-col",{attrs:{cols:"2",align:"end"}},[e("v-icon",{attrs:{size:"24"},on:{click:function(e){t.visible=!1}}},[t._v("mdi-close")])],1)],1)],1),e("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"190px !important"}},[e("v-form",{ref:"AddBarcode",staticClass:"CustomFormModifier",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"12"}},[e("v-autocomplete",{attrs:{rules:[t.validators.required],items:t.locations,"search-input":t.search,loading:t.loading,"cache-items":"","hide-no-data":"",label:"Search for location *","item-text":"stripped","item-value":"code",filled:"",outlined:""},on:{"update:searchInput":function(e){t.search=e},"update:search-input":function(e){t.search=e}},model:{value:t.location,callback:function(e){t.location=e},expression:"location"}})],1),e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"###################",expression:"'###################'"}],attrs:{rules:[t.validators.required],clearable:"",dense:"",outlined:"",label:"Barcode *"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.ExportRange.apply(null,arguments)}},model:{value:t.barcode,callback:function(e){t.barcode=e},expression:"barcode"}})],1)],1),e("v-row",{attrs:{"no-gutters":"",justify:"center"}},[e("v-btn",{staticClass:"mt-3 mb-5",attrs:{color:"primary",outlined:"",loading:t.loading_,disabled:!t.valid||t.loading_||t.barcode&&t.barcode.length<=6||t.location&&5===t.location.length},on:{click:t.Add}},[t._v("ADD BARCODE")])],1)],1)],1)],1)],1),e("Alert",{ref:"Alert"}),e("Snackbar",{ref:"Snackbar"})],1)},y=[],x={components:{Snackbar:d.Z},data(){return{visible:!1,valid:!1,loading:!1,loading_:!1,search:null,location:null,locations:[],barcode:null}},watch:{search(t){this.locations.length>0||this.loading||(this.loading=!0,this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}BarcodeControl/?storeId=${this.$route.params.id}&query=${t}`,{headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"}})).then((t=>{t.json().then((e=>{t.status>201?this.$refs.Alert.Alertify({visible:!0,content:"Error retrieving. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):this.locations=e}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>this.loading=!1)))},visible(t){t||this.$emit("Closed")}},methods:{ExportRange(){location.href=`${this.$store.getters.endpoint}Scans/Get/IndividualRange/?storeId=${this.$route.params.id}&token=${this.$store.getters.token}&from=${this.range.from}&to=${this.range.to}`,this.visible=!1},Add(){this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Scans/Add/`,{method:"post",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({storeId:Number(this.$route.params.id),location:this.location,barcode:Number(this.barcode)})})).then((t=>{t.text().then((()=>{t.status>201?this.$refs.Alert.Alertify({visible:!0,content:"Error while adding barcode. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.$refs.Alert.Alertify({visible:!0,content:`Barcode <b>${this.barcode}</b> was added to location <b>${this.location}</b>!`,title:"Added",icon:"mdi-check-decagram",color:"success"}),this.barcode=null)}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})}))}}},$=x,b=(0,f.Z)($,g,y,!1,null,null,null),k=b.exports;n().stylesLoaded=!0;var C={components:{Appbar:o.Z,Drawer:l.Z,Snackbar:d.Z,ExportRange:v,AddBarcode:k},data(){return{loading:!1,FancyGrid:{},FancyGridDefaults:{sortable:!0,editable:!1,resizable:!0,ellipsis:!1,filter:{header:!0,emptyText:"Search"},selected:null},IndividualScansGrid:{},FailedScansGrid:{},CumulativeScansGrid:{},DiscrepanciesReportGrid:{}}},mounted(){const t=[{operator:"eq",property:"storeId",value:`${this.$route.params.id}`}],e=encodeURI(JSON.stringify(t));this.$vuetify.breakpoint.mdAndUp&&(this.FancyGridDefaults["flex"]=1);let i=this;new Promise((t=>{t(1===this.FancyGridDefaults["flex"])})).then((()=>{this.IndividualScansGrid=new(n().Grid)({renderTo:"FancyTable",title:"Individual Product Scan",theme:{name:"material"},tbar:[{text:"Export All",handler:()=>{this.ExportIndividual()}},{text:"Export Range",handler:()=>this.$refs.ExportRange.visible=!0},{text:"Add barcode",handler:()=>this.$refs.AddBarcode.visible=!0},{text:"Refresh",handler:()=>{this.IndividualScansGrid.load()}},{text:"Delete Scans",handler:()=>{this.DeleteScans()}}],height:"fit",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:2,selModel:{type:"rows",memory:!0},columns:[{type:"select"},{type:"order",locked:!0},{index:"id",title:"#"},{index:"code",title:"Location Barcode"},{index:"barcode",title:"ProductBarcode",editable:!0},{index:"name",title:"Name"},{index:"quantity",title:"Quantity"},{index:"length",title:"Length"},{index:"color",title:"Color"},{index:"scannedBy",title:"Scanned By"},{index:"scannedOn",title:"Scanned On"},{index:"batteryLevel",title:"Battery Level"}],events:[{contextmenu:function(t,e){i.FancyGridDefaults.selected=e.data}},{endedit:function(t,e){e.data.barcode!=e.value&&(i.FancyGridDefaults.selected={...e.data,column:e.column.id},i.BarcodeControl("put"))}}],contextmenu:[{type:"duplicate",text:"Duplicate (Creates replica)",handler:function(t,e){i.BarcodeControl("post")}},{type:"delete",text:"Delete (Removes permanently)",handler:function(t,e){i.BarcodeControl(e.type)}}],data:{remotePage:!0,remoteFilter:!0,proxy:{autoLoad:!0,autoSave:!1,url:`${this.$store.getters.endpoint}Scans/Get/Individual/?filter=${e}`,params:{token:this.$store.getters.token,context:"display"},writer:{type:"json"},beforeRequest:t=>(this.$Progress.start(),t),afterRequest:t=>(this.$Progress.finish(),this.count=t.response.totalCount,t)}},paging:{pageSize:10,pageSizeData:[5,10,15,20],inputWidth:100,refreshButton:!0}})})),new Promise((t=>{t(1===this.FancyGridDefaults["flex"])})).then((()=>{this.FailedScansGrid=new(n().Grid)({renderTo:"Failed",title:"Failed Scans",theme:{name:"material"},tbar:[{text:"Export to Excel",handler:()=>{this.ExportFailed()}},{text:"Refresh",handler:()=>{this.FailedScansGrid.load()}},{text:"Delete Scans",handler:()=>{this.DeleteScans()}}],height:"fit",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:1,selModel:{type:"rows",memory:!0},columns:[{type:"select"},{type:"order",locked:!0},{index:"id",title:"#"},{index:"code",title:"Location Barcode"},{index:"barcode",title:"ProductBarcode"},{index:"name",title:"Name"},{index:"quantity",title:"Quantity"},{index:"length",title:"Length"},{index:"color",title:"Color"},{index:"scannedBy",title:"Scanned By"},{index:"scannedOn",title:"Scanned On"},{index:"batteryLevel",title:"Battery Level"}],data:{remotePage:!0,remoteFilter:!0,proxy:{autoLoad:!0,autoSave:!1,url:`${this.$store.getters.endpoint}Scans/Get/Failed/?filter=${e}`,params:{token:this.$store.getters.token,context:"display"},writer:{type:"json"},beforeRequest:t=>(this.$Progress.start(),t),afterRequest:t=>(this.$Progress.finish(),this.count=t.response.totalCount,t)}},paging:{pageSize:5,pageSizeData:[5,10],inputWidth:100,refreshButton:!0}})})),new Promise((t=>{t(1===this.FancyGridDefaults["flex"])})).then((()=>{this.CumulativeScansGrid=new(n().Grid)({renderTo:"Grouped",title:"Product Scan Count",theme:"material",tbar:[{text:"Export to TXT",handler:()=>{this.ExportTXT()}},{text:"Refresh",handler:()=>{this.CumulativeScansGrid.load()}}],height:"fit",selModel:"rows",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,columns:[{type:"order",locked:!0},{index:"barcode",title:"Product Barcode"},{index:"quantity",title:"Quantity"}],data:{proxy:{autoLoad:!0,autoSave:!1,url:`${this.$store.getters.endpoint}Scans/Get/Cumulative/`,params:{storeId:this.$route.params.id,token:this.$store.getters.token,context:"display"}}},paging:{pageSize:15,pageSizeData:[5,10,15,20,50],inputWidth:50}})})),new Promise((t=>{t(1===this.FancyGridDefaults["flex"])})).then((()=>{this.DiscrepanciesReportGrid=new(n().Grid)({renderTo:"Discrepancies",title:"Discrepancies Report",theme:{name:"material"},tbar:[{text:"Export to Excel",handler:()=>{this.ExportDiscrepancies()}},{text:"Refresh",handler:()=>{this.DiscrepanciesReportGrid.load()}}],height:"fit",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:1,selModel:{type:"rows",memory:!0},columns:[{type:"select"},{type:"order",locked:!0},{index:"id",title:"#"},{index:"code",title:"Location"},{index:"physicalCount",title:"Physical Count"},{index:"systemCount",title:"System Count"},{index:"discrepancy",title:"Discrepancy"}],data:{remotePage:!0,remoteFilter:!0,proxy:{autoLoad:!0,autoSave:!1,url:`${this.$store.getters.endpoint}Scans/Get/Discrepancies/?filter=${e}`,params:{token:this.$store.getters.token,context:"display"},writer:{type:"json"},beforeRequest:t=>(this.$Progress.start(),t),afterRequest:t=>(this.$Progress.finish(),this.count=t.response.totalCount,t)}},paging:{pageSize:5,pageSizeData:[5,10],inputWidth:100,refreshButton:!0}})}))},methods:{Confirm(t){if("show"===t.task)this.$refs.Confirm.Confirmify({visible:!0,task:t.task,operation:t.operation,metadata:t.metadata,content:t.content,title:t.title,icon:t.icon||"mdi-help-circle",color:t.color||"orange",truth:t.truth||"YES",falsy:t.falsy||"NO"});else if(t.task){if(this.$refs.Confirm.Confirmify({visible:!1}),"delete"===this.$refs.Confirm.confirm.operation){let t=this.$refs.Confirm.confirm.metadata,e=t.object,i=t.key;this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Stores/Delete/`,{method:"post",body:JSON.stringify({key:i})})).then((t=>{t.text().then((()=>{t.status>200?this.$refs.Alert.Alertify({visible:!0,content:"Error while deleting store. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.FancyGrid.remove(e),this.$refs.Snackbar.Snackify({visible:!0,content:"Store removed!",color:"success",timeout:2e3}))}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.loading=!1}))}}else t.task||this.$refs.Confirm.Confirmify({visible:!1})},DeleteScans(){let t=this.IndividualScansGrid.getSelection().map((t=>t.id));this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Scans/Delete/`,{method:"post",body:JSON.stringify({token:this.$store.getters.token,keys:t})})).then((t=>{t.text().then((()=>{t.status>200?this.$refs.Alert.Alertify({visible:!0,content:"Error while deleting store. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.IndividualScansGrid.load(),this.$refs.Snackbar.Snackify({visible:!0,content:"Items removed!",color:"success",timeout:2e3}))}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.loading=!1}))},BarcodeControl(t){this.FancyGridDefaults.selected={...this.FancyGridDefaults.selected,storeId:Number(this.$route.params.id)},this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}BarcodeControl/`,{method:t,headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify(this.FancyGridDefaults.selected)})).then((t=>{t.text().then((()=>{t.status>201?this.$refs.Alert.Alertify({visible:!0,content:"Error while duplicating store. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.IndividualScansGrid.load(),this.$refs.Snackbar.Snackify({visible:!0,content:"Items duplicated!",color:"success",timeout:2e3}))}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})}))},AddBarcodeClosed(){this.IndividualScansGrid.load()},ExportTXT(){location.href=`${this.$store.getters.endpoint}Scans/Get/Cumulative/?storeId=${this.$route.params.id}&token=${this.$store.getters.token}&context=export`},ExportIndividual(){location.href=`${this.$store.getters.endpoint}Scans/Get/Individual/?storeId=${this.$route.params.id}&token=${this.$store.getters.token}&context=export`},ExportFailed(){location.href=`${this.$store.getters.endpoint}Scans/Get/Failed/?storeId=${this.$route.params.id}&token=${this.$store.getters.token}&context=export`},ExportDiscrepancies(){location.href=`${this.$store.getters.endpoint}Scans/Get/Discrepancies/?storeId=${this.$route.params.id}&token=${this.$store.getters.token}&context=export`}},beforeDestroy(){clearInterval(window.ScansUpdate)}},S=C,w=(0,f.Z)(S,r,s,!1,null,null,null),A=w.exports}}]);