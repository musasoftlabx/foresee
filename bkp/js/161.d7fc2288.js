"use strict";(self["webpackChunkforesee"]=self["webpackChunkforesee"]||[]).push([[161],{32161:function(t,e,i){i.r(e),i.d(e,{default:function(){return R}});var o=function(){var t=this,e=t._self._c;return e("v-main",[e("Appbar"),e("Drawer"),e("v-container",{class:t.$vuetify.breakpoint.smAndUp&&"px-12 pt-6",attrs:{fluid:""}},[e("div",{staticClass:"ml-4 py-3"},[e("div",{staticClass:"text-h6 mb-4"},[t._v(" Locations in "+t._s(t.store.name)+" "),e("v-chip",{staticClass:"ml-2 subtitle-1",attrs:{small:"","text-color":"white",color:"primary"}},[e("span",[t._v(t._s(t.totalCount))])])],1),e("v-row",[e("v-btn",{staticClass:"mr-6",attrs:{rounded:"",color:"grey",text:""},on:{click:function(e){t.$refs.CreateLocation.visible=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-shape-polygon-plus")]),t._v("ADD LOCATION ")],1),e("v-btn",{staticClass:"mr-6",attrs:{rounded:"",color:"grey",text:""},on:{click:function(e){t.$refs.TabularLocationView.locations=t.dataset,t.$refs.TabularLocationView.visible=!0}}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-file-table-outline")]),t._v("VIEW & EXPORT LOCATIONS ")],1),e("v-btn",{staticClass:"mr-6",attrs:{rounded:"",color:"grey",text:"",to:`/Stores/${t.$route.params.id}/PrintLocations`}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-printer")]),t._v("PRINT LOCATIONS ")],1),e("v-btn",{attrs:{to:`/Stores/${t.$route.params.id}/Scans`,rounded:"",color:"grey",text:""}},[e("v-icon",{attrs:{left:""}},[t._v("mdi-barcode")]),t._v("SCANS ")],1)],1),e("v-row",[e("v-col",{attrs:{cols:"12",md:"4",lg:"3"}},[e("v-text-field",{ref:"Search",staticClass:"mb-2 ml-n2",attrs:{clearable:"",rounded:"",flat:"",dense:"",filled:"","hide-details":"","prepend-inner-icon":"mdi-table-search",label:"Search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.SearchLocations(!0)},"click:clear":function(e){return t.SearchLocations(!1)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),e("v-row",{attrs:{"no-gutters":"",align:"center"}},[e("span",{staticClass:"grey--text"},[t._v("Locations per page: ")]),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:i}){return[e("v-btn",t._g({staticClass:"ml-2",attrs:{dark:"",text:"",color:"primary"}},i),[t._v(" "+t._s(t.itemsPerPage)+" "),e("v-icon",[t._v("mdi-chevron-down")])],1)]}}])},[e("v-list",t._l(t.itemsPerPageArray,(function(i,o){return e("v-list-item",{key:o,on:{click:function(e){return t.updateItemsPerPage(i)}}},[e("v-list-item-title",[t._v(t._s(i))])],1)})),1)],1),e("span",{staticClass:"grey--text"},[t._v("Order by: ")]),e("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:i}){return[e("v-btn",t._g({staticClass:"ml-2",attrs:{dark:"",text:"",color:"primary"}},i),[t._v(" "+t._s(t.LocalStorage.LocationsOrder?JSON.parse(t.LocalStorage.LocationsOrder).key:"Latest")+" "),e("v-icon",[t._v("mdi-chevron-down")])],1)]}}])},[e("v-list",t._l([{key:"Latest",value:"id"},{key:"Most Discrepancies",value:"discrepancy"}],(function(i){return e("v-list-item",{key:i.value,on:{click:function(e){t.LocalStorage.LocationsOrder=JSON.stringify(i),t.sortBy=i.value,t.GetLocations()}}},[e("v-list-item-title",[t._v(t._s(i.key))])],1)})),1)],1)],1),e("v-row",t._l(t.entities,(function(i,o){return e("v-col",{key:o,attrs:{cols:"12",md:"2"}},[e("v-card",{staticClass:"mb-2 px-6 py-1 rounded-xl text-left",class:i.class,attrs:{dark:i.dark,outlined:!i.dark,hover:""},on:{click:i.onPress}},[e("div",{staticStyle:{margin:"10px",position:"absolute","background-color":"#fff","border-radius":"30px",height:"100px",top:"0",left:"0",width:"160px",opacity:"0"}}),e("div",{staticClass:"text-subtitle-2 mt-2"},[t._v(" "+t._s(i.name)+" ")]),e("div",{staticClass:"text-h6 font-weight-thin mt-n1 mb-1"},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"7"}},[e("span",{staticClass:"font-weight-bold"},[t._v(t._s(i.count))])])],1)],1)])],1)})),1)],1),e("v-row",{attrs:{justify:"center"}},[e("v-col",{attrs:{cols:"12",sm:"12"}},[e("v-data-iterator",{attrs:{items:t.dataset,"items-per-page":t.itemsPerPage,page:t.page,loading:t.loading,options:t.options,"server-items-length":t.pageCount,"hide-default-footer":""},on:{"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e},"update:page":function(e){t.page=e},"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"header",fn:function(){return[e("v-row",{attrs:{align:"center"}},[e("v-pagination",{attrs:{length:t.pageCount,"total-visible":11,color:"primary",circle:""},on:{input:function(e){t.page=e,t.GetLocations()},next:t.GetLocations,previous:t.GetLocations},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}),e("v-spacer"),e("v-col",{attrs:{align:"end",cols:"12",sm:"4"}},[e("div",[e("span",{staticClass:"mr-4 grey--text"},[t._v("Page "+t._s(t.page)+" of "+t._s(t.pageCount))]),e("v-btn",{staticClass:"mr-1",attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:t.formerPage}},[e("v-icon",[t._v("mdi-chevron-left")])],1),e("v-btn",{staticClass:"ml-1",attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:t.nextPage}},[e("v-icon",[t._v("mdi-chevron-right")])],1)],1)])],1)]},proxy:!0},{key:"no-data",fn:function(){return[e("v-row",{staticClass:"mt-10",attrs:{"no-gutters":"",justify:"center"}},[e("v-alert",{attrs:{text:"",outlined:"",color:"deep-orange",icon:"mdi-progress-alert"}},[t._v(" Mmmmh...looks like you don't have any locations currently. Click "),e("v-btn",{staticClass:"mx-2 GradientButton",staticStyle:{"margin-top":"-2px"},attrs:{color:"white",small:"",outlined:"",rounded:""},on:{click:function(e){t.$refs.CreateLocation.visible=!0}}},[t._v("ADD LOCATION ")]),t._v(" to add a new location. ")],1)],1)]},proxy:!0},{key:"loading",fn:function(){return[e("v-row",t._l(12,(function(t){return e("v-col",{key:t,attrs:{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"}},[e("v-skeleton-loader",{attrs:{type:"image"}})],1)})),1)]},proxy:!0},{key:"default",fn:function(i){return[e("v-row",t._l(i.items,(function(i,o){return e("v-col",{key:o,attrs:{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"}},[e("v-card",{staticClass:"rounded-b-xl elevation-3 px-5 pb-5 pt-4",staticStyle:{"border-top":"3px solid #7b68ee"},style:i.discrepancy>0?i.physicalCount>i.systemCount?"background: linear-gradient(#ffffff, #fff9f9); border-top: 3px solid rgba(200, 120, 0, 1)":"background: linear-gradient(#ffffff, #fff3f3); border-top: 3px solid rgba(255, 0, 0, 1)":1===i.edited?"background: linear-gradient(#ffffff, #f9fffc); border-top: 3px solid rgba(0, 100, 0, 1)":"border-top: 3px dashed rgba(0, 0, 0, 0.6)",attrs:{"max-width":"300"}},[i.daysElapsed<2?e("img",{staticStyle:{position:"absolute",left:"-12px",top:"-12px","z-index":"1"},attrs:{src:t.$store.getters.server+"img/CornerRibbon.png",width:"100px",height:"100px"}}):t._e(),e("v-row",{attrs:{id:`loc-${i.code}`,"no-gutters":"",justify:"center"}},[e("barcode",{attrs:{value:i.code.split("-")[0],text:i.code.split("-")[0],"text-margin":"5",width:1,height:"50","text-position":"top"}})],1),e("v-row",{staticClass:"mt-n2 mb-n6"},[e("v-col",{attrs:{cols:"6"}},[e("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"####",expression:"'####'"}],attrs:{rules:[t.validators.NumericsRegex],label:"Physical cnt",outlined:"",clearable:"",dense:"",hint:i.physicalCount>i.systemCount?"Greater --\x3e":"","persistent-hint":""},on:{focus:function(t){i.physicalCount=""},change:function(e){t.EditPhysicalCount(o,i.id,Number(i.physicalCount))}},model:{value:i.physicalCount,callback:function(e){t.$set(i,"physicalCount",e)},expression:"item.physicalCount"}})],1),e("v-col",{attrs:{cols:"6",align:"right"}},[e("v-text-field",{attrs:{rules:[t.validators.NumericsRegex],label:"System cnt",hint:i.systemCount>i.physicalCount?"<-- Greater":"",outlined:"",dense:"","persistent-hint":"",disabled:"",readonly:""},model:{value:i.systemCount,callback:function(e){t.$set(i,"systemCount",e)},expression:"item.systemCount"}})],1)],1),i.discrepancy>0?e("v-chip",{staticClass:"mt-4 ml-3 px-5",attrs:{color:i.physicalCount>i.systemCount?"rgba(200, 120, 0, 0.9)":"rgba(255, 0, 0, 0.6)",label:"","text-color":"white"}},[e("v-icon",{staticStyle:{"margin-top":"-2px"},attrs:{left:"",size:"18"}},[t._v(" mdi-close ")]),t._v(" Discrepancy: "+t._s(i.discrepancy)+" ")],1):t._e(),0===i.discrepancy&&1===i.edited?e("v-chip",{staticClass:"ml-3 px-5",attrs:{color:"rgba(0, 100, 0, 0.6)",label:"","text-color":"white"}},[e("v-icon",{staticStyle:{"margin-top":"-2px"},attrs:{left:"",size:"18"}},[t._v(" mdi-check ")]),t._v(" Matching counts ")],1):t._e(),e("div",{staticClass:"text-center caption mt-4"},[e("span",{staticClass:"font-weight-bold"},[t._v("Last Scanned On: ")]),e("span",[t._v(t._s(i.lastScannedOn))])]),e("div",{staticClass:"text-center caption mb-2"},[e("span",{staticClass:"font-weight-bold"},[t._v("Last Scanned By: ")]),e("span",{staticClass:"text-decoration-underline"},[t._v(t._s(i.lastScannedBy))])]),e("v-row",[e("v-col",{attrs:{cols:"4",align:"center"}},[e("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function({on:o,attrs:s}){return[e("v-btn",t._g(t._b({attrs:{color:"primary",fab:"",small:"",text:""},on:{click:function(e){return t.Print(i.code)}}},"v-btn",s,!1),o),[e("v-icon",[t._v("mdi-printer")])],1)]}}],null,!0)},[e("span",[t._v("Print Barcode")])])],1),e("v-col",{attrs:{cols:"4",align:"center"}},[e("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function({on:o,attrs:s}){return[e("v-btn",t._g(t._b({attrs:{color:"brown",fab:"",small:"",text:""},on:{click:function(e){return t.ShowProductsInLocation(i.code)}}},"v-btn",s,!1),o),[e("v-icon",[t._v("mdi-table-star")])],1)]}}],null,!0)},[e("span",[t._v("Show Products")])])],1),i.discrepancy>0||1===i.edited?e("v-col",{attrs:{cols:"4",align:"center"}},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:a}){return[e("v-btn",t._g(t._b({attrs:{color:"error",fab:"",small:"",text:""},on:{click:function(e){return t.Confirm({task:"show",operation:"delete",color:"warning",metadata:{index:o,key:i.id,code:i.code},icon:"mdi-history",content:"Proceed to reset location? Kindly note that this will reset the physical count and delete scans in this location.",title:"Reset location"})}}},"v-btn",a,!1),s),[e("v-icon",[t._v("mdi-history")])],1)]}}],null,!0)},[e("span",[t._v("Reset location")])])],1):t._e()],1)],1)],1)})),1)]}}])})],1)],1)],1),e("Alert",{ref:"Alert"}),e("Snackbar",{ref:"Snackbar"}),e("Confirm",{ref:"Confirm",on:{confirm:t.Confirm,cancel:t.Confirm}}),e("CreateLocation",{ref:"CreateLocation",attrs:{store:t.store},on:{NewLocation:t.NewLocation}}),e("Scanner",{ref:"Scanner"}),e("ProductsInLocation",{ref:"ProductsInLocation"}),e("TabularLocationView",{ref:"TabularLocationView",attrs:{store:t.store}}),e("router-view")],1)},s=[],a=(i(36353),i(66523)),r=i.n(a),n=i(63348),l=i(90427),c=i(46500),d=function(){var t=this,e=t._self._c;return e("section",[e("v-dialog",{attrs:{"max-width":"300",persistent:"",transition:"dialog-top-transition"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("v-card",{staticClass:"rounded-lg",attrs:{flat:""}},[e("div",{attrs:{id:"Modal-divider-top"}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 125",preserveAspectRatio:"none"}},[e("path",{staticClass:"divider-fill",staticStyle:{opacity:"0.5"},attrs:{d:"m 0,81.659348 c 81.99918,0 88.739113,19.697032 141.99858,19.697032 46.67953,0 33.12967,-19.551122 85.12915,-19.551122 57.49943,0 75.87924,34.141512 143.87856,34.141512 55.99944,0 98.99901,-36.475982 149.49851,-36.475982 76.49923,0 77.32923,29.482322 131.49868,43.284832 55.99944,14.2694 72.82927,-44.169982 142.82857,-44.169982 41.37959,0 74.35926,28.033012 103.68897,28.033012 C 942.67057,106.61865 1000,75.093678 1000,75.093678 V 24.999998 H 0 Z"}}),e("path",{staticClass:"divider-fill",attrs:{d:"m 0,81.988666 c 97.331947,-14.74806 115.33231,19.667594 176.67353,19.667594 53.33107,0 60.14121,-51.965834 122.64246,-51.965834 84.00168,0 116.35232,90.668944 200.004,73.034484 80.0016,-16.85492 86.00172,-63.205964 153.34306,-63.205964 49.661,0 86.65174,33.00405 124.00248,33.00405 33.33067,0 51.27103,-31.16054 78.00156,-31.16054 43.93088,0 51.28103,31.0868 97.90196,28.83245 C 976.99954,89.015066 1000,74.267006 1000,74.267006 V 5.8499091e-6 H 0 Z"}})])]),e("v-card",{staticClass:"px-8 pt-6",attrs:{dark:"",flat:"",color:"transparent"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"10"}},[e("div",{staticClass:"text-h5 font-weight-thin"},[t._v(" Create Location ")])]),e("v-col",{attrs:{cols:"2",align:"end"}},[e("v-icon",{attrs:{size:"24"},on:{click:function(e){t.visible=!1}}},[t._v("mdi-close")])],1)],1)],1),e("div",{staticClass:"pt-2 px-5 pb-0",staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-top":"200px !important"}},[e("v-form",{ref:"CreateLocation",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-row",{attrs:{"no-gutters":"",justify:"center"}},[e("v-dialog",{ref:"dialog",attrs:{"return-value":t.date.scanDate,persistent:"",width:"290px"},on:{"update:returnValue":function(e){return t.$set(t.date,"scanDate",e)},"update:return-value":function(e){return t.$set(t.date,"scanDate",e)}},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:o}){return[e("v-col",{staticClass:"px-2",attrs:{cols:"12"}},[e("v-text-field",t._g(t._b({attrs:{rules:[t.validators.required],label:"Expected Scan Date","prepend-inner-icon":"mdi-calendar",readonly:"",filled:"",rounded:"",dense:""},model:{value:t.date.scanDate,callback:function(e){t.$set(t.date,"scanDate",e)},expression:"date.scanDate"}},"v-text-field",o,!1),i))],1)]}}]),model:{value:t.date.visible,callback:function(e){t.$set(t.date,"visible",e)},expression:"date.visible"}},[e("v-date-picker",{attrs:{scrollable:""},model:{value:t.date.scanDate,callback:function(e){t.$set(t.date,"scanDate",e)},expression:"date.scanDate"}},[e("v-spacer"),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.date.visible=!1}}},[t._v(" Cancel ")]),e("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.dialog.save(t.date.scanDate)}}},[t._v(" OK ")])],1)],1),e("v-col",{staticClass:"px-2",attrs:{cols:"7"}},[e("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"####",expression:"'####'"}],attrs:{rules:[t.validators.required],label:"How many? *",filled:"",rounded:"",dense:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.CreateLocation.apply(null,arguments)}},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1),e("v-col",{staticClass:"px-2 pb-6",attrs:{cols:"12",align:"end"}},[e("v-btn",{attrs:{color:"primary",height:"35",rounded:"",text:"",loading:t.loading,disabled:!t.valid||t.loading},on:{click:t.CreateLocation}},[t._v("CREATE")])],1)],1)],1)],1)],1)],1),e("Alert",{ref:"Alert"})],1)},u=[],h={props:["store"],data(){return{visible:!1,loading:!1,valid:!1,date:{visible:!1,scanDate:null},quantity:1}},methods:{CreateLocation(){this.loading=!0,this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Locations/?Create`,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({storeId:this.$route.params.id,storeCode:this.store.code,quantity:Number(this.quantity),scanDate:{date:this.date.scanDate,formatted:Number(this.date.scanDate.split("-").join(""))}})})).then((t=>t.json().then((e=>{t.status>201?this.$refs.Alert.Alertify({visible:!0,content:e.content,title:e.title,icon:"mdi-progress-alert",color:"error"}):(this.$refs.CreateLocation.reset(),this.$emit("NewLocation",e),this.visible=!1)})))).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>this.loading=!1))}}},p=h,f=i(61431),v=(0,f.Z)(p,d,u,!1,null,null,null),m=v.exports,g=function(){var t=this,e=t._self._c;return e("section",[e("v-dialog",{attrs:{persistent:"","max-width":"350",transition:"dialog-top-transition"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("v-card",{staticClass:"rounded-lg pa-8 pb-2",attrs:{color:"primary",dark:""}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"10"}},[e("div",{staticClass:"text-h5 font-weight-thin"},[e("v-icon",{staticClass:"mr-3",attrs:{size:"26"}},[t._v("mdi-barcode")]),t._v(" Scan Barcode ")],1),e("div",{staticClass:"text-caption mt-1 ml-1",staticStyle:{color:"#bdffff"}},[t._v(" The barcode will appear below. It will be validated. ")])]),e("v-col",{attrs:{cols:"2",align:"end"}},[e("v-icon",{attrs:{size:"24"},on:{click:function(e){t.visible=!1}}},[t._v("mdi-close")])],1)],1),e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"12"}},[e("v-form",{ref:"Scanner"},[e("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"#############",expression:"'#############'"}],ref:"ProductBarcode",staticClass:"mt-6",attrs:{"solo-inverted":"",disabled:t.loading,rounded:""},scopedSlots:t._u([{key:"append",fn:function(){return[t.loading?e("v-progress-circular",{staticClass:"mr-n3",attrs:{color:"white",indeterminate:""}}):t._e()]},proxy:!0}]),model:{value:t.ProductBarcode,callback:function(e){t.ProductBarcode=e},expression:"ProductBarcode"}})],1)],1)],1)],1)],1),e("Snackbar",{ref:"Snackbar"})],1)},y=[],b={components:{Snackbar:c.Z},data(){return{visible:!1,LocationPK:null,LocationBarcode:null,ProductBarcode:null,loading:!1}},watch:{ProductBarcode(t){13===t.length&&this.ValidateScannedBarcode()}},methods:{ValidateScannedBarcode(){this.loading=!0,this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(this.$store.getters.endpoint+"ValidateScannedBarcode/",{method:"post",body:JSON.stringify({token:this.$store.getters.token,LocationPK:this.LocationPK,LocationBarcode:this.LocationBarcode,ProductBarcode:this.ProductBarcode})})).then((t=>{t.text().then((e=>{t.status>200?this.$refs.Snackbar.Snackify({visible:!0,content:e,color:"error",timeout:2e3}):this.$refs.Snackbar.Snackify({visible:!0,content:e,color:"success",timeout:2e3})}))})).catch((()=>{this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.$refs.Scanner.reset(),setTimeout((()=>{this.$refs.ProductBarcode.focus()}),100),this.loading=!1}))}}},x=b,C=(0,f.Z)(x,g,y,!1,null,null,null),k=C.exports,$=function(){var t=this,e=t._self._c;return e("section",[e("v-dialog",{attrs:{persistent:"","max-width":"80vw",transition:"scale-transition"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("v-card",{staticClass:"rounded-lg",attrs:{flat:"",color:"primary"}},[e("v-card",{staticClass:"px-8 py-6",attrs:{dark:"",flat:"",color:"transparent"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"10"}},[e("div",{staticClass:"text-h5 font-weight-thin"},[t._v("Products")]),e("div",{staticClass:"text-caption mt-0",staticStyle:{color:"#bdffff"}},[t._v(" Location: "),e("span",{staticClass:"yellow--text"},[t._v(t._s(t.location))])])]),e("v-col",{attrs:{cols:"2",align:"end"}},[e("v-icon",{attrs:{size:"24"},on:{click:function(e){t.visible=!1}}},[t._v("mdi-close")])],1)],1)],1),e("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","max-height":"calc(100vh - 200px)"}},[e("v-card",{attrs:{id:"ProductsInLocationContainer",outlined:"",tile:""}})],1)],1)],1)],1)},L=[],S=i(15442),w=i.n(S);w().stylesLoaded=!0;var _={data(){return{visible:!1,loading:!1,valid:!1,location:null,FancyGrid:{},FancyGridDefaults:{sortable:!0,editable:!1,resizable:!0,ellipsis:!1,filter:{header:!0,emptyText:"Search"}}}},watch:{visible(t){t?this.GetProducts():this.FancyGrid.destroy()}},methods:{GetProducts(){this.$vuetify.breakpoint.mdAndUp&&(this.FancyGridDefaults["flex"]=1),new Promise((t=>{t(1===this.FancyGridDefaults["flex"])})).then((()=>{this.FancyGrid=new(w().Grid)({renderTo:"ProductsInLocationContainer",theme:"material",tbar:[{text:"Export to CSV",handler:function(){this.exportToCSV({fileName:"Products In Location",header:!0})}}],height:"fit",selModel:"rows",stripped:!0,exporter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:1,columns:[{type:"order",locked:!0},{index:"id",title:"PK",hidden:!0},{index:"barcode",locked:!0,title:"Barcode"},{index:"SpecialCode",title:"Special Code"},{index:"section",title:"Section",filter:!1},{index:"location",title:"Location",filter:!1},{index:"name",title:"Name",editable:!0},{index:"quantity",title:"Quantity",filter:!1},{index:"size",title:"Size",editable:!0},{index:"length",title:"Length",editable:!0},{index:"ColorCode",title:"Color Code",editable:!0},{type:"combo",index:"color",title:"Color",editable:!0,data:["Brown","Khaki","Caramel","Black"]},{index:"LastScannedBy",title:"Last Scanned By"},{index:"LastScannedOn",title:"Last Scanned On"}],data:{proxy:{autoLoad:!0,url:`${this.$store.getters.endpoint}Locations/`,params:{products:!0,location:this.location},beforeRequest:t=>(t.headers["Authorization"]=`Bearer ${this.$store.getters.token}`,t),afterRequest:t=>t}},paging:{pageSize:20,pageSizeData:[5,10,15,20,50],inputWidth:100}})}))}}},P=_,A=(0,f.Z)(P,$,L,!1,null,null,null),T=A.exports,O=function(){var t=this,e=t._self._c;return e("section",[e("v-dialog",{attrs:{persistent:"","max-width":"80vw",transition:"scale-transition"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("v-card",{staticClass:"rounded-lg",attrs:{flat:"",color:"primary"}},[e("v-card",{staticClass:"px-8 py-6",attrs:{dark:"",flat:"",color:"transparent"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"10"}},[e("div",{staticClass:"text-h5 font-weight-thin"},[t._v("Locations")]),e("div",{staticClass:"text-caption mt-0",staticStyle:{color:"#bdffff"}},[t._v(" All locations citing discrepancy count. ")])]),e("v-col",{attrs:{cols:"2",align:"end"}},[e("v-icon",{attrs:{size:"24"},on:{click:function(e){t.visible=!1}}},[t._v("mdi-close")])],1)],1)],1),e("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","max-height":"calc(100vh - 200px)"}},[e("v-skeleton-loader",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"mt-1",attrs:{type:"table"}}),e("v-card",{attrs:{id:"LocationsContainer",outlined:"",tile:""}})],1)],1)],1)],1)},B=[];w().stylesLoaded=!0;var G={props:["store"],data(){return{visible:!1,loading:!1,locations:[],LocationsGrid:{},FancyGridDefaults:{sortable:!0,editable:!1,resizable:!0,ellipsis:!1,filter:{header:!0,emptyText:"Search"}}}},watch:{visible(t){t?this.RenderLocations():this.LocationsGrid.destroy()}},methods:{RenderLocations(){this.$vuetify.breakpoint.mdAndUp&&(this.FancyGridDefaults["flex"]=1),new Promise((t=>{t(1===this.FancyGridDefaults["flex"])})).then((()=>{const t=[{operator:"eq",property:"storeId",value:`${this.$route.params.id}`}],e=encodeURI(JSON.stringify(t));this.LocationsGrid=new(w().Grid)({renderTo:"LocationsContainer",theme:"blue",tbar:[{text:"Export All Locations",handler:()=>{this.ExportCSV()}},{text:"Export Deleted Locations",handler:()=>{this.LocationsGrid.addFilter("active",0),setTimeout((()=>{this.LocationsGrid.exportToCSV({fileName:"Deleted Locations",header:!0,ignoreRender:!0}),this.LocationsGrid.clearFilter()}),1e3)}}],height:"fit",selModel:"rows",stripped:!0,exporter:!0,filter:!0,defaults:this.FancyGridDefaults,trackOver:!0,clicksToEdit:1,columns:[{type:"order",locked:!0},{index:"id",title:"#",hidden:!0},{index:"code",locked:!0,title:"Code",width:200},{index:"physicalCount",title:"Physical Count",editable:!0},{index:"systemCount",title:"System Count",editable:!0},{index:"discrepancy",title:"Discrepancy",exportFn:t=>(t.value=t.data.discrepancy,t),render:t=>(t.value>0?t.style={color:"#E46B67","font-weight":"bold","font-size":"14px"}:t.style={color:"#65AE6E"},t)},{index:"isActive",title:"Is Active?",editable:!0,type:"switcher",exportFn:t=>(1==t.value?t.value="Yes":t.value="No",t),render:t=>(1==t.value?t.value=!0:t.value=!1,t)},{index:"modifiedBy",title:"Modified By"},{index:"modifiedOn",title:"Modified On"}],data:{remotePage:!0,remoteFilter:!0,proxy:{autoLoad:!0,autoSave:!1,methods:{read:"GET"},api:{read:`${this.$store.getters.endpoint}Locations/?filter=${e}`},writer:{type:"json"},beforeRequest:t=>(this.loading=!0,t.headers["Authorization"]=`Bearer ${this.$store.getters.token}`,t),afterRequest:t=>(this.loading=!1,this.visible=!0,t)}},paging:{pageSize:20,pageSizeData:[5,10,15,20,50],inputWidth:100,refreshButton:!0},events:[{change:(t,e)=>{this.$Progress.start(),this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Locations/Edit/`,{method:"post",body:JSON.stringify({token:this.$store.getters.token,resource:"sections",key:e.id,entity:e.key,value:e.value})})).then((t=>{t.text().then((()=>{t.status>200?(this.$Progress.fail(),this.$refs.Alert.Alertify({title:"Update Error!",content:"The last change you made could not be saved. Kindly retry.",visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"})):(location.reload(),this.FancyGrid.save(e))}))})).catch((()=>{this.$Progress.fail(),this.$refs.Alert.Alertify({title:"Connection Timeout",content:this.$store.getters.fetchTimeoutError,visible:!0,icon:"mdi-wifi-strength-1-alert",color:"error"})})).finally((()=>{this.$Progress.finish()}))}}]})}))},ExportCSV(){location.href=`${this.$store.getters.endpoint}Locations/Export/?storeId=${this.$route.params.id}&store=${this.store.name}&token=${this.$store.getters.token}`}}},D=G,E=(0,f.Z)(D,O,B,!1,null,null,null),N=E.exports,I={components:{barcode:r(),Appbar:n.Z,Drawer:l.Z,Snackbar:c.Z,CreateLocation:m,Scanner:k,ProductsInLocation:T,TabularLocationView:N},data(){return{loading:!1,autorefresh:!1,timer:0,headers:[],dataset:[],options:{},totalCount:0,itemsPerPageArray:[20,25,30],search:"",SearchResults:[],filter:"",page:1,pageCount:1,itemsPerPage:20,FilterCount:0,sortBy:"id",entities:[{name:"Total",image:"store.png",icon:"mdi-store",count:0,dark:!0,class:"Total",filters:[],onPress:()=>{localStorage.setItem("filterLocationsBy","Total"),this.GetLocations([])}},{name:"Counted",image:"store.png",icon:"mdi-store",count:0,dark:!0,class:"Counted",filters:[{operator:"custom",property:"counted",value:1}],onPress:()=>{localStorage.setItem("filterLocationsBy","Counted"),this.GetLocations([{operator:"custom",property:"counted",value:1}])}},{name:"Not Counted",image:"section.png",icon:"mdi-account-multiple",count:0,dark:!1,class:"NotCounted",filters:[{operator:"eq",property:"isVerified",value:0},{operator:"eq",property:"systemCount",value:0}],onPress:()=>{localStorage.setItem("filterLocationsBy","Not Counted"),this.GetLocations([{operator:"eq",property:"isVerified",value:0},{operator:"eq",property:"systemCount",value:0}])}},{name:"Discrepancies",image:"location.png",icon:"mdi-target-variant",count:0,dark:!0,class:"Discrepancies",filters:[{operator:"custom",property:"discrepancy",value:0}],onPress:()=>{localStorage.setItem("filterLocationsBy","Discrepancies"),this.GetLocations([{operator:"custom",property:"discrepancy",value:0}])}}],store:{}}},mounted(){this.GetData(),this.timer=setInterval((()=>{this.GetData()}),1e4)},methods:{GetLocations(t){this.$Progress.start(),this.loading=!0;const e=localStorage.LocationsOrder?JSON.parse(localStorage.LocationsOrder).value:this.sortBy,i=[{operator:"eq",property:"storeId",value:`${this.$route.params.id}`}];t&&t.forEach((t=>i.push(t)));const o=encodeURI(JSON.stringify(i)),s=`${this.$store.getters.endpoint}Locations/?filter=${o}&page=${this.page-1}&limit=${this.itemsPerPage}&sort=${e}&order=0`;this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(s,{headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"}})).then((t=>t.json().then((t=>{this.dataset=t.data,this.store=t.store,this.totalCount=t.totalCount,this.pageCount=Math.ceil(this.totalCount/this.itemsPerPage),Object.entries(t.cumulativeCount).forEach((t=>{const[e,i]=t;this.entities.forEach((t=>{t.name===e&&(t.count=i)}))}))})))).catch((()=>this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"}))).finally((()=>(this.loading=!1,this.$Progress.finish())))},SearchLocations(t){if(t){this.$Progress.start(),this.loading=!0;const t=localStorage.LocationsOrder?JSON.parse(localStorage.LocationsOrder).value:this.sortBy,e=[{operator:"rx",property:"code",value:this.search},{operator:"eq",property:"storeId",value:`${this.$route.params.id}`}],i=encodeURI(JSON.stringify(e)),o=`${this.$store.getters.endpoint}Locations/?filter=${i}&page=${this.page-1}&limit=${this.itemsPerPage}&sort=${t}&order=0`;this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(o,{headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"}})).then((t=>t.json().then((t=>{this.dataset=t.data,this.totalCount=t.totalCount,this.pageCount=Math.ceil(this.totalCount/this.itemsPerPage)})))).catch((()=>this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"}))).finally((()=>this.$Progress.finish()))}else this.GetLocations()},ShowProductsInLocation(t){this.$refs.ProductsInLocation.location=t,this.$refs.ProductsInLocation.visible=!0},GetData(){const t=localStorage.filterLocationsBy;t?this.GetLocations(this.entities[this.entities.findIndex((e=>e.name===t))].filters):this.GetLocations(this.entities[0].filters)},NewLocation(t){this.GetLocations(this.entities[0].filters),this.$refs.Snackbar.Snackify({visible:!0,content:`Created ${t.length} location${t.length>1?"s":""}.`,color:"success",timeout:3e3})},EditPhysicalCount(t,e,i){i&&i>0&&this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Locations/?ResetPhysicalCount`,{method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({id:e,physicalCount:i})})).then((e=>e.text().then((()=>{e.status>200?this.$refs.Alert.Alertify({visible:!0,content:"Error while editing count. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.dataset[t].edited=1,this.dataset[t].discrepancy=i,this.$refs.Snackbar.Snackify({visible:!0,content:"Edited physical count!",color:"success",timeout:2e3}))})))).catch((()=>this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"}))).finally((()=>{this.loading=!1}))},nextPage(){this.page+1<=this.pageCount&&(this.page++,this.GetLocations())},formerPage(){this.page-1>=1&&(this.page--,this.GetLocations())},updateItemsPerPage(t){this.itemsPerPage=t},Confirm(t){if("show"===t.task)this.$refs.Confirm.Confirmify({visible:!0,task:t.task,operation:t.operation,metadata:t.metadata,content:t.content,title:t.title,icon:t.icon||"mdi-help-circle",color:t.color||"info",truth:t.truth||"YES",falsy:t.falsy||"NO"});else if(t.task){this.$refs.Confirm.Confirmify({visible:!1});let t=this.$refs.Confirm.confirm.metadata,e=t.index,i=t.key;"delete"===this.$refs.Confirm.confirm.operation&&this.promiseFetch(this.$store.getters.fetchTimeout)(fetch(`${this.$store.getters.endpoint}Locations/`,{method:"DELETE",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.getters.token}`,"Content-Type":"application/json"},body:JSON.stringify({id:i,code:t.code})})).then((t=>t.text().then((()=>{t.status>200?this.$refs.Alert.Alertify({visible:!0,content:"Error resetting location. Kindly try again",title:"Error",icon:"mdi-progress-alert",color:"error"}):(this.dataset[e].PhysicalCount=0,this.dataset[e].SystemCount=0,this.dataset[e].edited=0,this.dataset[e].discrepancy=0,this.$refs.Snackbar.Snackify({visible:!0,content:"Location has been reset.",color:"success",timeout:2e3}))})))).catch((()=>this.$refs.Alert.Alertify({visible:!0,content:this.$store.getters.fetchTimeoutError,title:"Connection Timeout",icon:"mdi-wifi-strength-1-alert",color:"error"})))}else t.task||(this.$refs.Confirm.Confirmify({visible:!1}),this.dataset[this.$refs.Confirm.confirm.metadata.index].PhysicalCount="")},async Print(t){await this.$htmlToPaper(`loc-${t}`)},filterOnlyCapsText(t,e){return null!=t&&null!=e&&"string"===typeof t&&-1!==t.toString().toLocaleUpperCase().indexOf(e)}},computed:{numberOfPages(){return console.log(this.numberOfPages),Math.ceil(this.dataset.length/this.itemsPerPage)}},destroyed(){clearInterval(this.timer)}},F=I,z=(0,f.Z)(F,o,s,!1,null,null,null),R=z.exports}}]);